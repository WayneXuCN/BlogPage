---
title: 机箱风扇控制
author: 徐文杰
pubDatetime: 2023-05-26 19:06:14
modDatetime: 2023-05-26 19:06:14
description: 设定温度曲线控制机箱风扇速度
tags:
  - Hardware
  - Optimization
category: Tools
featured: false
draft: false
slug: "zh/case-fan-control"
lang: zh
---

## 前言

以前从没觉得自己的 ATX 主机吵。直到新装了一台 ITX 小主机，才意识到：ATX 真的很吵。当它和另一台 mini 主机并排放在一起时，这种差异变得直观，曾被我嫌弃「吵」的 mini 主机，反而显得安静了。

主板自带的风扇调速功能选择很少，只能依据主板温度或 CPU 温度。我把 CPU 低温区间的风扇转速压到极低，却几乎没有变化。问题可能出在铭瑄的 BIOS，也可能是机箱风扇本身就不适合精细调速。

但机箱风扇真正需要高速运转的场景，其实并不多。最典型的是显卡高负载。问题在于，主板并不是主要热源，它只是被动受热。用主板温度去决定机箱风扇转速，本身就存在滞后和误差。理想的做法，是根据显卡温度来调节机箱风扇。但 BIOS 里做不到。

机箱风扇什么时候需要高速运转呢？一般是在显卡高负载时。而主板自带的风扇调速依赖于主板的温度传感器，但主板并不是主要发热源，只是间接受热，这之间存在误差。根据显卡温度调节机箱风扇速度才是正解，但 BIOS 里无法这样设置。

最后只能另寻出路。我在 GitHub 上找到了一个叫 FanControl 的小工具，功能相当完整，正好解决了这个问题，顺手记一笔。

## 转速控制

FanControl 的界面由三个模块组成：**Controls(控制)**、**Speeds(速度)**、**Curves(曲线)**。

![image-20240620182749451](https://xwj770427414.oss-cn-beijing.aliyuncs.com/img/image-20240620182749451.png)

起初只是随手调了调，很快就暴露出两个问题：

- 一是机箱风扇无法通过软件控制，而 CPU 风扇可以；
- 二是两个机箱风扇长期以最高转速运行，稳定在 1350 rpm。

这也解释了噪音的来源。实际上我一共装过四个机箱风扇，已经拆掉了两个，否则情况只会更糟。

查了下型号，是 Arctic F12，3Pin 接口，风评并不差。常见评价也很一致：1000 转以下安静，超过之后噪音明显。问题不在风扇品质，而在控制方式。继续翻参数才发现关键点：这款风扇不支持 PWM 调节。主板里怎么调都没反应，并不意外。再进 BIOS 查看，两个机箱风扇里只有一个支持 DC 调速，另一个选项直接缺失，原因暂时不明，可能和接口有关，之后再拆开确认。

上来先随便调了调，突然就发现了问题，我的机箱风扇没法通过这个软件控制，CPU 风扇可以。另外一个问题是，原来我的两个机箱风扇一直是跑在最高转速（1350 rpm），我人都傻了，我说怎么那么吵。原来有四个机箱风扇，得亏我拆了两个。顺手查了查风扇信息，Arctic F12 3Pin，风扇风评还是不错的，没有买错。但也有人指出，1000 转一下很安静，1000 转以上就很吵。保存设置后，机箱外侧的风扇终于可以被正常控制。至此，转速调节才真正有了意义。

![image-20240620184306186](https://xwj770427414.oss-cn-beijing.aliyuncs.com/img/image-20240620184306186.png)

## 参数设置

- **Curves 是需要我们手动制定的转速规则**，首次启动时是空的，需要手动添加。右下角加号即可，新建 Linear 或 Graph 都很直观。
  - Hysteresis、Response time 主要影响响应灵敏度，保持默认即可。
  - Temperature source 我直接设为 GPU 温度，这是机箱风扇最真实的负载来源。
  - 相比 Linear，我更倾向 Graph 曲线，逻辑更直观，也更容易微调：
    - 低温阶段（CPU/GPU 温度低于 40°C）；风扇转速：10-20%；保持最低噪音，应对轻度负载即可。
    - 中温阶段（CPU/GPU 温度在 40°C 到 60°C 之间）；风扇转速：20-40%；适应中等负载，覆盖日常使用和轻度游戏，噪音仍在可控范围。
    - 高温阶段（CPU/GPU 温度高于 60°C）；风扇转速：40-100%；面对高负载时优先散热，转速随温度上升而加快，但不追求线性。

![image-20240620185657196](https://xwj770427414.oss-cn-beijing.aliyuncs.com/img/image-20240620185657196.png)

- **Speeds**列表对应系统中识别到的所有风扇，默认以 Fan #1、Fan #2 命名，可以自行重命名，便于区分。
- **Controls**负责把风扇与曲线绑定。
  - 点击 Control 右上角的设置、Select matching fan 进行风扇绑定。
  - Control 的参数本身很直白：Enable：开关；Fan curve：选择已配置的曲线；offset：用于微调多个风扇之间的转速差异。

---

完成这些设置后，机箱风扇终于不再全速待命，转速随负载变化，噪音也回到了一个合理水平。

![image-20240620190508654](https://xwj770427414.oss-cn-beijing.aliyuncs.com/img/image-20240620190508654.png)
